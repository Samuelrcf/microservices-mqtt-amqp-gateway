package com.ufersa.mqttservice.services;

import org.eclipse.paho.client.mqttv3.MqttClient;
import org.eclipse.paho.client.mqttv3.MqttConnectOptions;

public class MQTTService {
    MqttClient client = new MqttClient("tcp://broker.hivemq.com:1883", MqttClient.generateClientId());
    MqttConnectOptions options = new MqttConnectOptions();
    options.setAutomaticReconnect(true);
    options.setCleanSession(true);

    client.connect(options);
    System.out.println("Consumidor MQTT conectado ao broker.");
    System.out.println("Inscrito no tÃ³pico: " + topic);

    client.subscribe(topic, (t, msg) -> {
        System.out.println("Mensagem recebida [MQTT]: " + new String(msg.getPayload()));
    });
}
